Part₁ ← (
  °/$"_\n_"
  ⊃↘↙¯1
  ⊓(⍉≡◇(⋕⊢⍉regex"\\d+")
  | ≡°□⊢⍉regex"\\S+"°□⊢)
  ˜≡(
    ⍣(/+ °"+"
    | /×°"*"
    )
  )
  /+
)

┌─╴test
  $ 123 328  51 64
  $  45 64  387 23 
  $   6 98  215 314
  $ *   +   *   +  
  ⍤⤙≍ 4277556 Part₁
└─╴

Part₂ ← (
  ⊃↘↙¯1 °/$"_\n_"
  ⍉⬚@\s≡°□
)

┌─╴test
  $ 123 328  51 64
  $  45 64  387 23 
  $   6 98  215 314
  $ *   +   *   +  
  ⍤⤙≍ 3263827 Part₂
└─╴
